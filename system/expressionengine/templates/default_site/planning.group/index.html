{!--}
1. remove all indv fields and make them one big box w/ prefilled text
2. make creative form after the process of adding event? Prefilled text post approval?
3. 
{--}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>Communications Planning</title>

	<link href="/strap/dist/css/bootstrap.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="//cloud.typography.com/6186432/755202/css/fonts.css" />
	<link rel="stylesheet" href="/_css/font-awesome.css" type='text/css'>
	<link href="{path=css/_ee_channel_form_css}" type="text/css" rel="stylesheet" media="screen">
	
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
	<script type="text/javascript" src="/_js/jquery.cookie.js"></script>
	<script type="text/javascript" src="/_js/jquery.cookies.2.2.0.min.js"></script>
	{exp:jquery:script_tag ui='datepicker'}
	
	<script src="/strap/dist/js/bootstrap.min.js"></script>

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
		<script src="/strap/assets/js/html5shiv.js"></script>
		<script src="/strap/assets/js/respond.min.js"></script>
		<![endif]-->
		
	<script type="text/javascript">
	$(function() {
		$('#datepicker').datepicker({
			timeFormat: "hh:mm TT"
		});
	});
	</script>
	
	<script type="text/javascript">
		var datalog = "";
		var consolelogtime;

		// Use this one for bug reporting
		console = { log: function(data) {
				datalog = datalog + data + "\n";		
			} 
		};

		$(document).ready(function() {
			InitializeScreennameHeader();
			InitializeLoginClickHandlers();
			document.cookie="jrnych_screenname={screen_name}";
		});

		function ee_logout() {
			  document.cookie =  'jrnych_screenname=; expires=Thu, 01 Jan 1970 00:00:01 GMT; Max-Age=0';
			$.ajax({
			  	url: "/?ACT=16",
			  	complete: function() { window.location.reload(true); }
			});
		}

		function getCookie(cname) {
		    var name = cname + "=";
		    var ca = document.cookie.split(';');
		    for(var i=0; i<ca.length; i++) {
		        var c = ca[i].trim();
		        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
		    }
		    return "";
		}
		
		// Update logged in header info from cookie
		function InitializeScreennameHeader() {
		    var username=getCookie("jrnych_screenname");
		    if (username!="") {
		        $("#logged_status").html('<p id="logged-in">' + username + ' - <a onclick="javascript:ee_logout();" class="logout">Log Out</a></p>');
		    }else{
				$("#logged_status").html('<a class="user-login" href="#login-register-box">Login</a>');
			    $(window).load(function(){
			        $('#loggedout').modal({
						backdrop: 'static',
						keyboard: true
			        });
			    });
		    }
		}
		
		function InitializeLoginClickHandlers() {
			$(".logout").click(function(){
				$.ajax({
				  	url: "/index.php?ACT=16",
				  	complete: function(){
				  		window.location.reload(true);
					}
				});
				return false;
			});

			$(".login_form").submit(function() {
				var values = $(this).serialize();
				$.ajax({
					url: '/index.php?ACT=15',
					type: 'POST',
					data: values,
					success: function(data) {	
						var pos = data.indexOf("<title>Error");
						var titlePos = data.indexOf("<title>");
						$('.modal-body').html("You are currently being logged in.");
						window.location.reload(true);
					}
				});
					
				return false;
			});
		}
	</script>
	
	<style type="text/css">
		body {margin: 0 20px!important; width:2000px; overflow-x: scroll;}
		#loggedout {background-color:rgb(49, 49, 49);}
	</style>
</head>

<body>
	{!--}	
		<section>
			<div class="container">
				<?php 
					 $firstUrl = date('Y-m-d', strtotime(date('Y-m-d')." Sunday this week"));
				?>
				
				{exp:channel:entries channel="planning_week" show_expired="yes" show_future_entries="yes" limit="1" dynamic="yes" url_title="2014-02-09"}
						<?php
							$date = new DateTime('{title}');
							$newtitle = $date->format('F jS, Y');
						?>
						<h2>
							Week of <?php echo $newtitle ?>
							<div class="pull-right">
								{exp:channel:prev_entry channel="planning_week"}
									<a href="/planning/{prev_entry->title}">
										<i class="fa fa-chevron-left"></i>
									</a>
								{/exp:channel:prev_entry}
								
								{exp:channel:next_entry channel="planning_week"}
									<a href="/planning/{next_entry->title}">
										<i class="fa fa-chevron-right"></i>
									</a>
								{/exp:channel:next_entry}
							</div>
						</h2>
							
						{embed="planning/item" itemtitle="Worship Guide" urltitle="{url_title}" itemname="worshipguide"}
						{embed="planning/item" itemtitle="Video Announcements" urltitle="{url_title}" itemname="videoann"}
						{embed="planning/item" itemtitle="Insert" urltitle="{url_title}" itemname="insert"}
						{embed="planning/item" itemtitle="Email" urltitle="{url_title}" itemname="email"}
						{embed="planning/item" itemtitle="Social Media" urltitle="{url_title}" itemname="socialmedia"}
						{embed="planning/item" itemtitle="Blog" urltitle="{url_title}" itemname="blog"}
						{embed="planning/item" itemtitle="Experience Video" urltitle="{url_title}" itemname="experiencevideo"}
						{embed="planning/item" itemtitle="Notes for Pastor Clark" urltitle="{url_title}" itemname="pastor"}

				{/exp:channel:entries}
				
				<div class="clearfix"></div>
			</div>
		</section>
	{--}
	<section>
		<h2>Communications Planning</h2>
		<div id="logged_status" style="display:none"></div>
	</section>
	<section>
		<div class="">
			<div class="panel panel-default">
			 	<div class="panel-heading">
					<a data-toggle="modal" data-target="#addEvent" href="#">
						<strong><i class="fa fa-plus"></i> Add Event</strong>
					</a>
				</div>
				<table class="table table-hover table-condensed table-bordered" style="overflow:scroll">
					<thead>
						<tr>
							<th>Event Name</th>
							<th>Tier</th>
							<th>Date</th>
							<th>Location</th>
							<th>Owner</th>
							<th>Event Contact</th>
							<th class="col-sm-4">Blurb</th>
							<th>Detailed Event Info</th>
							<th>Promo Dates</th>
							<th>Annc Vid</th>
							<th>Promo Vid</th>
							<th>Worship Guide</th>
							<th>Social</th>
							<th>Email</th>
							<th>Insert</th>
							<th>Other</th>
						</tr>
					</thead>
					<tbody class="planning-items">
						{exp:channel:entries channel="Planning" show_future_entries="yes" orderby="{planning-event_date format='%Y-%m-%d'}" sort="asc" dynamic="no"}
							{if planning-approved == "Yes" OR logged_in_member_id == author_id OR member_group == "1" OR member_group == "7"}
								<tr data-toggle="modal" {if logged_in_member_id == author_id OR member_group=="1" OR member_group=="7"}data-target="#edit{entry_id}"{/if} style="{if planning-approved != 'Yes'}background-color:rgb(244, 225, 209){/if}">
									<td>
										{title}
									</td>
									<td>{categories}{category_name}<br>{/categories}</td>
									<td>
										{planning-event_date format="%m/%d/%Y"}
										
										{!-- If start and end dates are same 
										{if "{entry_date format='%m/%d/%y %g:%i%a'}" == "{expiration_date format='%m/%d/%y %g:%i%a'}"}
											{entry_date format="%m/%d/%y"}
											
										-- If dates are same but times are different 
										{if:elseif "{entry_date format='%m/%d/%y'}" == "{expiration_date format='%m/%d/%y'}" && "{entry_date format='%g:%i%a'}" != "{expiration_date format='%g:%i%a'}"}
											{entry_date format="%m/%d/%y %g:%i%a"} - {expiration_date format='%g:%i%a'}
											
										-- If dates are different 
										{if:elseif "{entry_date format='%m/%d/%y'}" != "{expiration_date format='%m/%d/%y'}" && "{entry_date format='%g:%i%a'}" == "{expiration_date format='%g:%i%a'}"}
											{entry_date format="%m/%d/%y"} -<br> {expiration_date format='%m/%d/%y'}
										
										-- If dates and times are different 
										{if:elseif "{entry_date format='%m/%d/%y'}" != "{expiration_date format='%m/%d/%y'}" && "{entry_date format='%g:%i%a'}" != "{expiration_date format='%g:%i%a'}"}
											{entry_date format="%m/%d/%y %g:%i%a"} -<br> {expiration_date format='%m/%d/%y %g:%i%a'}
										{/if}
										{--}
									</td>
									<td>{planning-location}</td>
									<td>{planning-person}</td>
									<td>{planning-contact}</td>
									<td>{planning-blurb}</td>
									<td>{planning-desc}</td>
									<td>{planning-promo_dates}</td>
									<td>{planning-annc}</td>
									<td>{planning-promovid}</td>
									<td>{planning-guide}</td>
									<td>{planning-social}</td>
									<td>{planning-theemail}</td>
									<td>{planning-theinsert}</td>
									<td>{planning-other}</td>
								</tr>
							{/if}
								
							{if logged_in_member_id == author_id OR member_group=="1" OR member_group=="7"}{embed="planning/edit" editid="{entry_id}"}{/if}
						{/exp:channel:entries}
					</tbody>
				</table>
			</div>
		</div>
	</section>
	
	{embed="planning/add"}
	
	<div class="modal fade" id="loggedout" tabindex="-1" role="dialog" aria-hidden="true">
			<div id="accordion" class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h4 class="modal-title">Login</h4>
					</div>
					<div id="normallogin" class="panel-collapse collapse in" data-parent="#accordion">
						{exp:member:login_form form_class="login_form" return="<?php echo $_SERVER['HTTP_REFERER']; ?>"}
							<div class="modal-body">
								<div id="normallogin" class="collapse in">
									<label>Username</label><br>
									<input type="text" name="username" value="" maxlength="40" size="40" class="form-control">
									<br>
									<label>Password</label><br>
									<input type="password" name="password" value="" maxlength="40" size="40" class="form-control">
									<br>
									<p data-toggle="collapse" data-target="#forgotpass">
									  Forgot your password?
									</p>
								</div>
							</div>
							<div class="modal-footer">
								<input type="submit" name-"submit" class="btn btn-primary" value="Submit">
							</div>
						{/exp:member:login_form}
					</div>
					<div id="forgotpass" class="panel-collapse collapse" data-parent="#accordion">
						<form id="forgot_password_form" method="post" action="http://journeychurch.tv/">
							<div class="modal-body">
								<div class="hiddenFields">
									<input type="hidden" name="XID" value="bd77593c46c41e84e3687c57bd38e6be76ec691e">
									<input type="hidden" name="ACT" value="17">
									<input type="hidden" name="FROM" value="">
									<input type="hidden" name="site_id" value="1">
								</div>
								<label>Email Address</label>
								<p><input type="text" name="email" value="" maxlength="40" size="40" class="form-control"></p>
							</div>
							<div class="modal-footer">
								<input type="submit" name-"submit" class="btn btn-primary" value="Submit">
							</div>
						</form>
					</div>
				</div>
			</div>
	</div>
</body>
</html>
